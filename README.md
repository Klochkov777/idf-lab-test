# idf-lab-test
##Проект является тестом.
## В проекте согласно заданию было решено использовать следующие технологии:
1. В качестве базы данных использовалась PostgreSQL
2. Для разработки приложения Spring Boot 3.2.4 и Java 21. Был реализован следующий фукционал
* Получать информацию о каждой расходной операции в тенге (KZT), рублях (RUB)
     и других валютах в реальном времени и сохранять ее в своей собственной базе
     данных (БД);
* Хранить месячный лимит по расходам в долларах США (USD) раздельно для двух
  категорий расходов: товаров и услуг.
* Запрашивать данные биржевых курсов валютных пар KZT/USD, RUB/USD по
  дневному интервалу (1day/daily) и хранить их в собственной базе данных. При
  расчете курсов использовать данные закрытия (close). Данную задачу решил с помощью webclient, работает асинхронно
* Помечать транзакции, превысившие месячный лимит операций (технический флаг
  limit_exceeded);
* Дать возможность клиенту установить новый лимит. При установлении нового
  лимита микросервисом автоматически выставляется текущая дата, не позволяя
  выставить ее в прошедшем или будущем времени. Обновлять существующие
  лимиты запрещается
* По запросу клиента возвращать список транзакций, превысивших лимит, с
  указанием лимита, который был превышен (дата установления, сумма лимита,
  валюта (USD)) 
3. Разработка велась на ветке develop, ветка master для проверки (prod). для реализации CI/CD использовались следующие возможности
   * GitHub Actions. при push веток feature/* проект автоматически собирался и тестировался. При mearge с веткой develop собирался в docker image и push на github repository, что давало возможность разработчику получить свежее обновление проекта если бы работа была не в одиночку. Затем проект при merge с веткой master  push на dockerhub, я решил отделить, чтобы было понятно , что на dockerhub проект к prod.
   * есть файл в проекте Dockerfile для создания image и три варианта файла docker-compose.yml. Во всех поднимается docker с приложением, postgrsql, pgadmin для удобства работы с бд. Разница в этих файлах за счет откуда будет получен image проекта.
   * подводя итог CI/CD проект можно получить создав image из Dockerfile либо ghcr.io/klochkov777/idf-lab-test:latest из github repository, либо из dockerhub. Либо полностью развернутую инфраструктуру запустив один из трех файдов для docker-compose
4. Тестирование не было проведено в полном объеме из-за ограничения по времени на выполнение задания. Был поднят testcotainer и написан один метод не в полном объеме дляпоказа понимания принципа интеграционного тестирования
5. Для миграции бд использовалась liquibase. Также для наполнения тестовыми данными тестовой бд (тестконтейнер) использовалась liquibase с context="test"